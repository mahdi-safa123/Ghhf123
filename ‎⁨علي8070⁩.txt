<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù</title>
<style>
body {
font-family: Arial, sans-serif;
background: #f0f2f5;
display: flex;
justify-content: center;
align-items: center;
height: 100vh;
margin: 0;
padding: 0;
}
.container {
background: white;
padding: 30px;
border-radius: 10px;
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
text-align: center;
width: 90%;
max-width: 400px;
}
input, button {
padding: 10px;
margin: 10px 0;
width: 100%;
font-size: 16px;
border-radius: 5px;
}
button {
background-color: #007bff;
color: white;
border: none;
cursor: pointer;
}
button:hover {
background-color: #0056b3;
}
.actions {
display: flex;
gap: 10px;
}
.actions button {
flex: 1;
}
.fingerprint {
font-size: 60px;
cursor: pointer;
display: none;
margin-top: 20px;
color: #007bff;
}
table {
width: 100%;
border-collapse: collapse;
margin-top: 15px;
text-align: center;
}
th, td {
border: 1px solid #ccc;
padding: 8px;
}
th {
background: #007bff;
color: white;
}
</style>
</head>
<body>
<div id="app" class="container"></div>

<script>
const ADMIN_USER = "Ù…Ù‡Ø¯ÙŠ";
const ADMIN_PASS = "80808080";
let currentType = "";
let userName = localStorage.getItem("username") || "";
let isAdmin = false;

function init() {
if (userName) {
showUserActions();
} else {
showLogin();
}
}

function showLogin() {
document.getElementById('app').innerHTML = `
<h2>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ø¯Ù…Ù†</h2>
<input type="text" id="adminUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" />
<input type="password" id="adminPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±" />
<button onclick="login()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
`;
}

function login() {
const user = document.getElementById("adminUser").value;
const pass = document.getElementById("adminPass").value;
if (user === ADMIN_USER && pass === ADMIN_PASS) {
isAdmin = true;
showAdminDashboard();
} else {
alert("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
}
}

function showAdminDashboard() {
document.getElementById('app').innerHTML = `
<h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${ADMIN_USER}</h2>
<h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
<table id="dailyReport">
<thead>
<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø§Ù„Ø­Ø¶ÙˆØ±</th><th>Ø§Ù„Ø§Ù†ØµØ±Ø§Ù</th></tr>
</thead>
<tbody></tbody>
</table>
<h3>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„ØºÙŠØ§Ø¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ</h3>
<table id="monthlyReport">
<thead>
<tr><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¶ÙˆØ±</th><th>Ø£ÙŠØ§Ù… Ø§Ù„Ø§Ù†ØµØ±Ø§Ù</th></tr>
</thead>
<tbody></tbody>
</table>
<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
`;
loadReports();
}

function logout() {
isAdmin = false;
userName = "";
localStorage.removeItem("username");
init();
}

function loadReports() {
const records = JSON.parse(localStorage.getItem('attendanceRecords') || '{}');
const today = new Date().toISOString().slice(0,10);
const dailyBody = document.querySelector("#dailyReport tbody");
const monthlyBody = document.querySelector("#monthlyReport tbody");

dailyBody.innerHTML = "";
monthlyBody.innerHTML = "";

let allNamesSet = new Set();
for (const day in records) {
for (const name in records[day]) {
allNamesSet.add(name);
}
}
const allNames = Array.from(allNamesSet);

allNames.forEach(name => {
const statusToday = records[today] && records[today][name] ? records[today][name] : "âŒ";
dailyBody.innerHTML += `
<tr>
<td>${name}</td>
<td>${statusToday === 'Ø­Ø¶ÙˆØ±' ? 'âœ…' : 'âŒ'}</td>
<td>${statusToday === 'Ø§Ù†ØµØ±Ø§Ù' ? 'âœ…' : 'âŒ'}</td>
</tr>
`;
});

const month = new Date().toISOString().slice(0,7);
allNames.forEach(name => {
let attendanceCount = 0;
let leaveCount = 0;
for (const day in records) {
if (day.startsWith(month)) {
if (records[day][name] === "Ø­Ø¶ÙˆØ±") attendanceCount++;
if (records[day][name] === "Ø§Ù†ØµØ±Ø§Ù") leaveCount++;
}
}
monthlyBody.innerHTML += `
<tr>
<td>${name}</td>
<td>${attendanceCount}</td>
<td>${leaveCount}</td>
</tr>
`;
});
}

function showUserActions() {
document.getElementById('app').innerHTML = `
<h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${userName}</h2>
<div class="actions">
<button onclick="selectType('Ø­Ø¶ÙˆØ±')">Ø­Ø¶ÙˆØ±</button>
<button onclick="selectType('Ø§Ù†ØµØ±Ø§Ù')">Ø§Ù†ØµØ±Ø§Ù</button>
</div>
<div id="fingerprint" class="fingerprint" onclick="submit()" title="Ø§Ø¶ØºØ· Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨ØµÙ…Ø©">ğŸ”’</div>
${isAdmin ? `<button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>` : ''}
`;
}

function selectType(type) {
currentType = type;
document.getElementById("fingerprint").style.display = 'block';
}

function submit() {
if (!currentType) {
alert("Ø§Ø®ØªØ± Ø­Ø¶ÙˆØ± Ø£Ùˆ Ø§Ù†ØµØ±Ø§Ù Ø£ÙˆÙ„Ø§Ù‹");
return;
}

const today = new Date().toISOString().slice(0,10);
let records = JSON.parse(localStorage.getItem('attendanceRecords') || '{}');

if (!records[today]) records[today] = {};

if (records[today][userName] && records[today][userName] === currentType) {
alert(`Ù„Ù‚Ø¯ Ù‚Ù…Øª Ø¨ØªØ³Ø¬ÙŠÙ„ ${currentType} Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ… Ù…Ø³Ø¨Ù‚Ø§Ù‹.`);
return;
}

records[today][userName] = currentType;
localStorage.setItem('attendanceRecords', JSON.stringify(records));
alert(`${currentType} ØªÙ… ØªØ³Ø¬ÙŠÙ„ ${userName} Ø¨Ù†Ø¬Ø§Ø­`);
document.getElementById("fingerprint").style.display = 'none';
currentType = "";
if (!isAdmin) {
showUserActions();
}
}

init();
</script>
</body>
</html>